
; This syntax tries to match how Intel documents their opcodes in terms of keywords
; /r = mod/reg/rm field, opcode uses mod, reg, and rm fields
; /0 through /7 = mod/reg/rm field, opcode is chosen by reg field, uses mod and r/m fields
; ib = immediate byte
; ib.sx = immediate byte sign extended to a word (non-standard extension to Intel syntax)
; iw = immediate word
; mo = immediate memory address, meaning a word that describes a memory address
; cb = immediate byte, when in the context of a jump or call
; cw = immediate word, when in the context of a jump or call
; cd = immediate double word, usually a memory offset followed by a word containing a segment value

; 8086 opcodes

opcode 0x00 /r,               name "ADD",            display "ADD r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x01 /r,               name "ADD",            display "ADD r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x02 /r,               name "ADD",            display "ADD r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x03 /r,               name "ADD",            display "ADD r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x04 ib,               name "ADD",            display "ADD al, imm8",               dest rw al,      src imm8;
opcode 0x05 iw,               name "ADD",            display "ADD ax, imm16",              dest rw ax,      src imm16;

opcode 0x06,                  name "PUSH",           display "PUSH es",                    dest w stack16,  src es;
opcode 0x07,                  name "POP",            display "POP es",                     dest w es,       src stack16;

opcode 0x08 /r,               name "OR",             display "OR r/m8, r8",                dest rw r/m8,    src r8;
opcode 0x09 /r,               name "OR",             display "OR r/m16,r16",               dest rw r/m16,   src r16;
opcode 0x0A /r,               name "OR",             display "OR r8, r/m8",                dest rw r8,      src r/m8;
opcode 0x0B /r,               name "OR",             display "OR r16, r/m16",              dest rw r16,     src r/m16;
opcode 0x0C ib,               name "OR",             display "OR al, imm8",                dest rw al,      src imm8;
opcode 0x0D iw,               name "OR",             display "OR ax, imm16",               dest rw ax,      src imm16;

opcode 0x0E,                  name "PUSH",           display "PUSH cs",                    dest w stack16,  src cs;
opcode 0x0F,                  name "POP",            display "POP cs",                     dest w cs,       src stack16;

opcode 0x10 /r,               name "ADC",            display "ADC r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x11 /r,               name "ADC",            display "ADC r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x12 /r,               name "ADC",            display "ADC r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x13 /r,               name "ADC",            display "ADC r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x14 ib,               name "ADC",            display "ADC al, imm8",               dest rw al,      src imm8;
opcode 0x15 iw,               name "ADC",            display "ADC ax, imm16",              dest rw ax,      src imm16;

opcode 0x16,                  name "PUSH",           display "PUSH ss",                    dest w stack16,  src ss;
opcode 0x17,                  name "POP",            display "POP ss",                     dest w ss,       src stack16;

opcode 0x18 /r,               name "SBB",            display "SBB r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x19 /r,               name "SBB",            display "SBB r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x1A /r,               name "SBB",            display "SBB r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x1B /r,               name "SBB",            display "SBB r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x1C ib,               name "SBB",            display "SBB al, imm8",               dest rw al,      src imm8;
opcode 0x1D iw,               name "SBB",            display "SBB ax, imm16",              dest rw ax,      src imm16;

opcode 0x1E,                  name "PUSH",           display "PUSH ds",                    dest w stack16,  src ds;
opcode 0x1F,                  name "POP",            display "POP ds",                     dest w ds,       src stack16;

opcode 0x20 /r,               name "AND",            display "AND r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x21 /r,               name "AND",            display "AND r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x22 /r,               name "AND",            display "AND r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x23 /r,               name "AND",            display "AND r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x24 ib,               name "AND",            display "AND al, imm8",               dest rw al,      src imm8;
opcode 0x25 iw,               name "AND",            display "AND ax, imm16",              dest rw ax,      src imm16;

opcode 0x26,                  name "ES:",            display "ES:",                        prefix segoverride, src es;
opcode 0x27,                  name "DAA",            display "DAA",                        dest rw al,      src al;

opcode 0x28 /r,               name "SUB",            display "SUB r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x29 /r,               name "SUB",            display "SUB r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x2A /r,               name "SUB",            display "SUB r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x2B /r,               name "SUB",            display "SUB r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x2C ib,               name "SUB",            display "SUB al, imm8",               dest rw al,      src imm8;
opcode 0x2D iw,               name "SUB",            display "SUB ax, imm16",              dest rw ax,      src imm16;

opcode 0x2E,                  name "CS:",            display "CS:",                        prefix segoverride, src cs;
opcode 0x2F,                  name "DAS",            display "DAS",                        dest rw al,      src al;

opcode 0x30 /r,               name "XOR",            display "XOR r/m8, r8",               dest rw r/m8,    src r8;
opcode 0x31 /r,               name "XOR",            display "XOR r/m16,r16",              dest rw r/m16,   src r16;
opcode 0x32 /r,               name "XOR",            display "XOR r8, r/m8",               dest rw r8,      src r/m8;
opcode 0x33 /r,               name "XOR",            display "XOR r16, r/m16",             dest rw r16,     src r/m16;
opcode 0x34 ib,               name "XOR",            display "XOR al, imm8",               dest rw al,      src imm8;
opcode 0x35 iw,               name "XOR",            display "XOR ax, imm16",              dest rw ax,      src imm16;

opcode 0x36,                  name "SS:",            display "SS:",                        prefix segoverride, src ss;
opcode 0x37,                  name "AAA",            display "AAA",                        dest rw ax,      src al;

opcode 0x38 /r,               name "CMP",            display "CMP r/m8, r8",                                src r/m8 r8;
opcode 0x39 /r,               name "CMP",            display "CMP r/m16,r16",                               src r/m16 r16;
opcode 0x3A /r,               name "CMP",            display "CMP r8, r/m8",                                src r8 r/m8;
opcode 0x3B /r,               name "CMP",            display "CMP r16, r/m16",                              src r16 r/m16;
opcode 0x3C ib,               name "CMP",            display "CMP al, imm8",                                src al imm8;
opcode 0x3D iw,               name "CMP",            display "CMP ax, imm16",                               src ax imm16;

opcode 0x3E,                  name "DS:",            display "DS:",                        prefix segoverride, src ds;
opcode 0x3F,                  name "AAS",            display "AAS",                        dest rw ax,      src al;

opcode [0x40-0x47],           name "INC",            display "INC r16",                    dest rw r16,                                     ri=oplow3;
opcode [0x48-0x4F],           name "DEC",            display "DEC r16",                    dest rw r16,                                     ri=oplow3;

opcode [0x50-0x57],           name "PUSH",           display "PUSH r16",                   dest w stack16,  src r16,                        ri=oplow3;
opcode [0x58-0x5F],           name "POP",            display "POP r16",                    dest w r16,      src stack16,                    ri=oplow3;

opcode 0x60,                  alias of 0x70;
opcode 0x61,                  alias of 0x71;
opcode 0x62,                  alias of 0x72;
opcode 0x63,                  alias of 0x73;
opcode 0x64,                  alias of 0x74;
opcode 0x65,                  alias of 0x75;
opcode 0x66,                  alias of 0x76;
opcode 0x67,                  alias of 0x77;
opcode 0x68,                  alias of 0x78;
opcode 0x69,                  alias of 0x79;
opcode 0x6A,                  alias of 0x7A;
opcode 0x6B,                  alias of 0x7B;
opcode 0x6C,                  alias of 0x7C;
opcode 0x6D,                  alias of 0x7D;
opcode 0x6E,                  alias of 0x7E;
opcode 0x6F,                  alias of 0x7F;

opcode 0x70 cb,               name "JO",             display "JO rel8",                    dest rw ip,      src rel8;
opcode 0x71 cb,               name "JNO",            display "JNO rel8",                   dest rw ip,      src rel8;
opcode 0x72 cb,               name "JB",             display "JB rel8",                    dest rw ip,      src rel8;
opcode 0x73 cb,               name "JNB",            display "JNB rel8",                   dest rw ip,      src rel8;
opcode 0x74 cb,               name "JZ",             display "JZ rel8",                    dest rw ip,      src rel8;
opcode 0x75 cb,               name "JNZ",            display "JNZ rel8",                   dest rw ip,      src rel8;
opcode 0x76 cb,               name "JBE",            display "JBE rel8",                   dest rw ip,      src rel8;
opcode 0x77 cb,               name "JA",             display "JA rel8",                    dest rw ip,      src rel8;
opcode 0x78 cb,               name "JS",             display "JS rel8",                    dest rw ip,      src rel8;
opcode 0x79 cb,               name "JNS",            display "JNS rel8",                   dest rw ip,      src rel8;
opcode 0x7A cb,               name "JPE",            display "JPE rel8",                   dest rw ip,      src rel8;
opcode 0x7B cb,               name "JPO",            display "JPO rel8",                   dest rw ip,      src rel8;
opcode 0x7C cb,               name "JL",             display "JL rel8",                    dest rw ip,      src rel8;
opcode 0x7D cb,               name "JGE",            display "JGE rel8",                   dest rw ip,      src rel8;
opcode 0x7E cb,               name "JLE",            display "JLE rel8",                   dest rw ip,      src rel8;
opcode 0x7F cb,               name "JG",             display "JG rel8",                    dest rw ip,      src rel8;

opcode 0x80 /0 ib,            name "ADD",            display "ADD r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /1 ib,            name "OR",             display "OR r/m8, imm8",              dest rw r/m8,    src imm8;
opcode 0x80 /2 ib,            name "ADC",            display "ADC r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /3 ib,            name "SBB",            display "SBB r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /4 ib,            name "AND",            display "AND r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /5 ib,            name "SUB",            display "SUB r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /6 ib,            name "XOR",            display "XOR r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x80 /7 ib,            name "CMP",            display "CMP r/m8, imm8",                              src r/m8 imm8;

opcode 0x81 /0 iw,            name "ADD",            display "ADD r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /1 iw,            name "OR",             display "OR r/m16, imm16",            dest rw r/m16,   src imm16;
opcode 0x81 /2 iw,            name "ADC",            display "ADC r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /3 iw,            name "SBB",            display "SBB r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /4 iw,            name "AND",            display "AND r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /5 iw,            name "SUB",            display "SUB r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /6 iw,            name "XOR",            display "XOR r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x81 /7 iw,            name "CMP",            display "CMP r/m16, imm16",                            src r/m16 imm16;

opcode 0x82 /0 ib,            name "ADD",            display "ADD r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /1 ib,            name "OR",             display "OR r/m8, imm8",              dest rw r/m8,    src imm8;
opcode 0x82 /2 ib,            name "ADC",            display "ADC r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /3 ib,            name "SBB",            display "SBB r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /4 ib,            name "AND",            display "AND r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /5 ib,            name "SUB",            display "SUB r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /6 ib,            name "XOR",            display "XOR r/m8, imm8",             dest rw r/m8,    src imm8;
opcode 0x82 /7 ib,            name "CMP",            display "CMP r/m8, imm8",                              src r/m8 imm8;

opcode 0x83 /0 ib.sx,         name "ADD",            display "ADD r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /1 ib.sx,         name "OR",             display "OR r/m16, imm16",            dest rw r/m16,   src imm16;
opcode 0x83 /2 ib.sx,         name "ADC",            display "ADC r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /3 ib.sx,         name "SBB",            display "SBB r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /4 ib.sx,         name "AND",            display "AND r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /5 ib.sx,         name "SUB",            display "SUB r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /6 ib.sx,         name "XOR",            display "XOR r/m16, imm16",           dest rw r/m16,   src imm16;
opcode 0x83 /7 ib.sx,         name "CMP",            display "CMP r/m16, imm16",                            src r/m16 imm16;

opcode 0x84 /r,               name "TEST",           display "TEST r/m8, r8",                               src r/m8 r8;
opcode 0x85 /r,               name "TEST",           display "TEST r/m16, r16",                             src r/m16 r16;
opcode 0x86 /r,               name "XCHG",           display "XCHG r/m8, r8",              dest rw r/m8,    src rw r8;
opcode 0x87 /r,               name "XCHG",           display "XCHG r/m16, r16",            dest rw r/m16,   src rw r16;

opcode 0x88 /r,               name "MOV",            display "MOV r/m8, r8",               dest w r/m8,     src r8;
opcode 0x89 /r,               name "MOV",            display "MOV r/m16, r16",             dest w r/m16,    src r16;
opcode 0x8A /r,               name "MOV",            display "MOV r8, r/m8",               dest w r8,       src r/m8;
opcode 0x8B /r,               name "MOV",            display "MOV r16, r/m16",             dest w r16,      src r/m16;
opcode 0x8C /r,               name "MOV",            display "MOV r/m16, sreg",            dest w r/m16,    src sreg;

opcode 0x8D /r,               name "LEA",            display "LEA r16, r/m16",             dest w r16,      src effective r/m16,     if r/m16 is memory;

opcode 0x8E /r,               name "MOV",            display "MOV sreg, r/m16",            dest w sreg,     src r/m16;

opcode 0x8F /0,               name "POP",            display "POP r/m16",                  dest w r/m16,    src stack16;

opcode 0x90,                  name "NOP",            display "NOP";
opcode [0x91-0x97],           name "XCHG",           display "XCHG r16,ax",                dest rw r16,     src rw ax,                      ri=oplow3;

opcode 0x98,                  name "CBW",            display "CBW",                        dest rw ax,      src al;
opcode 0x99,                  name "CWD",            display "CWD",                        dest rw dx:ax,   src ax;

opcode 0x9A cd,               name "CALL",           display "CALL ptr16:16",              dest rw cs:ip,   src ptr16:16;

opcode 0x9B,                  name "WAIT",           display "WAIT";

opcode 0x9C,                  name "PUSHF",          display "PUSHF",                      dest w stack16,  src flags;
opcode 0x9D,                  name "POPF",           display "POPF",                       dest flags,      src w stack16;

opcode 0x9E,                  name "SAHF",           display "SAHF",                       dest flags,      src ah;
opcode 0x9F,                  name "LAHF",           display "LAHF",                       dest ah,         src flags;

opcode 0xA0 mo,               name "MOV",            display "MOV al,moffs8",              dest w al,       src moffs8;
opcode 0xA1 mo,               name "MOV",            display "MOV ax,moffs16",             dest w ax,       src moffs16;
opcode 0xA2 mo,               name "MOV",            display "MOV moffs8,al",              dest w moffs8,   src al;
opcode 0xA3 mo,               name "MOV',            display "MOV moffs16,ax",             dest w moffs16,  src ax;

opcode 0xA4,                  name "MOVSB",          display "MOVSB",                      dest w es:di,    src r ds:si,   mb;
opcode 0xA5,                  name "MOVSW",          display "MOVSW",                      dest w es:di,    src r ds:si,   mw;
opcode 0xA6,                  name "CMPSB",          display "CMPSB",                                       src r es:di r ds:si,   mb;
opcode 0xA7,                  name "CMPSW",          display "CMPSW",                                       src r es:di r ds:si,   mw;

opcode 0xA8 ib,               name "TEST",           display "TEST al,imm8",                                src al imm8;
opcode 0xA9 iw,               name "TEST",           display "TEST ax,imm16",                               src ax imm16;

opcode 0xAA,                  name "STOSB",          display "STOSB",                      dest w es:di,    src al;
opcode 0xAB,                  name "STOSW",          display "STOSW",                      dest w es:di,    src ax;
opcode 0xAC,                  name "LODSB",          display "LODSB",                      dest al,         src r ds:si;
opcode 0xAD,                  name "LODSW",          display "LODSW",                      dest ax,         src r ds:si;
opcode 0xAE,                  name "SCASB",          display "SCASB",                                       src r es:di al;
opcode 0xAF,                  name "SCASW",          display "SCASW",                                       src r es:di ax;

opcode [0xB0-0xB7] ib,        name "MOV",            display "MOV r8,ib",                  dest w r8,       src ib,                         ri=oplow3;
opcode [0xB8-0xBF] iw,        name "MOV",            display "MOV r16,iw",                 dest w r16,      src iw,                         ri=oplow3;

opcode 0xC0,                  alias of 0xC2;
opcode 0xC1,                  alias of 0xC3;

opcode 0xC2 iw,               name "RET",            display "RET iw",                     dest rw ip,      src iw;
opcode 0xC3,                  name "RET",            display "RET",                        dest rw ip;

opcode 0xC4 /r,               name "LES",            display "LES r16,r/m16",              dest es:r16,     src r/m16;
opcode 0xC5 /r,               name "LDS",            display "LDS r16,r/m16",              dest ds:r16,     src r/m16;

opcode 0xC6 /0 ib,            name "MOV",            display "MOV r/m8, imm8",             dest w r/m8,     src imm8;
opcode 0xC7 /0 iw,            name "MOV",            display "MOV r/m16, imm16",           dest w r/m16,    src imm16;

opcode 0xCA iw,               name "RETF",           display "RETF iw",                    dest w cs:ip,    src stack16 stack16;
opcode 0xCB,                  name "RETF",           display "RETF",                       dest w cs:ip,    src stack16 stack16;

opcode 0xCC,                  name "INT3",           display "INT3",                       software interrupt 3;
opcode 0xCD ib,               name "INT",            display "INT ib",                     software interrupt ib;
opcode 0xCE,                  name "INTO",           display "INTO",                       software interrupt 4 conditional, src flags;
opcode 0xCF,                  name "IRET",           display "IRET",                       interrupt return;

opcode 0xD0 /0,               name "ROL",            display "ROL r/m8, 1",                dest rw r/m8;
opcode 0xD0 /1,               name "ROR",            display "ROR r/m8, 1",                dest rw r/m8;
opcode 0xD0 /2,               name "RCL",            display "RCL r/m8, 1",                dest rw r/m8;
opcode 0xD0 /3,               name "RCR",            display "RCR r/m8, 1",                dest rw r/m8;
opcode 0xD0 /4,               name "SHL",            display "SHL r/m8, 1",                dest rw r/m8;
opcode 0xD0 /5,               name "SHR",            display "SHR r/m8, 1",                dest rw r/m8;
opcode 0xD0 /6,               name "SAL",            display "SAL r/m8, 1",                dest rw r/m8;
opcode 0xD0 /7,               name "SAR",            display "SAR r/m8, 1",                dest rw r/m8;

opcode 0xD1 /0,               name "ROL",            display "ROL r/m16, 1",               dest rw r/m16;
opcode 0xD1 /1,               name "ROR",            display "ROR r/m16, 1",               dest rw r/m16;
opcode 0xD1 /2,               name "RCL",            display "RCL r/m16, 1",               dest rw r/m16;
opcode 0xD1 /3,               name "RCR",            display "RCR r/m16, 1",               dest rw r/m16;
opcode 0xD1 /4,               name "SHL",            display "SHL r/m16, 1",               dest rw r/m16;
opcode 0xD1 /5,               name "SHR",            display "SHR r/m16, 1",               dest rw r/m16;
opcode 0xD1 /6,               name "SAL",            display "SAL r/m16, 1",               dest rw r/m16;
opcode 0xD1 /7,               name "SAR",            display "SAR r/m16, 1",               dest rw r/m16;

opcode 0xD2 /0,               name "ROL",            display "ROL r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /1,               name "ROR",            display "ROR r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /2,               name "RCL",            display "RCL r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /3,               name "RCR",            display "RCR r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /4,               name "SHL",            display "SHL r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /5,               name "SHR",            display "SHR r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /6,               name "SAL",            display "SAL r/m8, cl",               dest rw r/m8,    src cl;
opcode 0xD2 /7,               name "SAR",            display "SAR r/m8, cl",               dest rw r/m8,    src cl;

opcode 0xD3 /0,               name "ROL",            display "ROL r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /1,               name "ROR",            display "ROR r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /2,               name "RCL",            display "RCL r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /3,               name "RCR",            display "RCR r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /4,               name "SHL",            display "SHL r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /5,               name "SHR",            display "SHR r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /6,               name "SAL",            display "SAL r/m16, cl",              dest rw r/m16,   src cl;
opcode 0xD3 /7,               name "SAR",            display "SAR r/m16, cl",              dest rw r/m16,   src cl;

opcode 0xD4 ib,               name "AAM",            display "AAM ib",                     dest rw ax,      src al ib;
opcode 0xD5 ib,               name "AAD",            display "AAD ib",                     dest rw ax,      src ax ib;

opcode 0xD7,                  name "XLAT",           display "XLAT",                       dest rw al,      src ds:bx;

; NTS: D8-DF are "escapes" to the FPU. Where the 8087 datasheet says "ESCAPE" it means 11011 i.e ESCAPE 000 means 11011000 = 0xD8
opcode 0xD8 [0xD0-0xD7],      name "FCOM",           display "FCOM st(i)",                                  src st(0), st(i),               stidx=oplow3;
opcode 0xD8 [0xD8-0xDF],      name "FCOMP",          display "FCOMP st(i)",                                 src st(0), st(i),               stidx=oplow3;
opcode 0xD9 /0,               name "FLD",            display "FLD m32fp",                  dest w fpustack, src r/m32,                                    fpustackpush;
opcode 0xD9 /2,               name "FST",            display "FST m32fp",                  dest r/m32,      src st(0);
opcode 0xD9 /3,               name "FST",            display "FSTP m32fp",                 dest r/m32,      src st(0),                                    fpustackpop;
opcode 0xD9 [0xC0-0xC7],      name "FLD",            display "FLD st(i)",                  dest w fpustack, src st(i),                      stidx=oplow3, fpustackpush;

opcode 0xDB /0,               name "FILD",           display "FLD m32int",                 dest w fpustack, src r/m32,                                    fpustackpush;
opcode 0xDB /2,               name "FIST",           display "FIST m32int",                dest r/m32,      src st(0);
opcode 0xDB /3,               name "FISTP",          display "FISTP m32int",               dest r/m32,      src st(0),                                    fpustackpop;
opcode 0xDB /5,               name "FLD",            display "FLD m80fp",                  dest w fpustack, src r/m80,                                    fpustackpush;
opcode 0xDB /7,               name "FSTP",           display "FSTP m80fp",                 dest r/m80,      src st(0),                                    fpustackpop;

opcode 0xDD /0,               name "FLD",            display "FLD m64fp",                  dest w fpustack, src r/m64,                                    fpustackpush;
opcode 0xDD /2,               name "FST",            display "FST m64fp",                  dest r/m64,      src st(0),                                    fpustackpop;
opcode 0xDD /3,               name "FSTP",           display "FSTP m64fp",                 dest r/m80,      src st(0),                                    fpustackpop;
opcode 0xDD [0xD0-0xD7],      name "FST",            display "FST st(i)",                  dest st(i),      src st(0),                      stidx=oplow3;
opcode 0xDD [0xD8-0xDF],      name "FSTP",           display "FSTP st(i)",                 dest st(i),      src st(0),                      stidx=oplow3, fpustackpop;

; the 8087 datasheet still refers to this as FLD but with BCD, I am using later documentation
opcode 0xDF /0,               name "FILD",           display "FILD m16int",                dest w fpustack, src r/m16,                                    fpustackpush;
opcode 0xDF /2,               name "FIST",           display "FIST m16int",                dest r/m16,      src st(0);
opcode 0xDF /3,               name "FISTP",          display "FISTP m16int",               dest r/m16,      src st(0),                                    fpustackpush;
opcode 0xDF /4,               name "FBLD",           display "FBLD m80dec",                dest w fpustack, src r/m80,                                    fpustackpush;
opcode 0xDF /5,               name "FILD",           display "FILD m64int",                dest w fpustack, src r/m64,                                    fpustackpush;
opcode 0xDF /6,               name "FBSTP",          display "FBSTP m80bcd",               dest r/m80,      src st(0),                                    fpustackpop;
opcode 0xDF /7,               name "FISTP",          display "FISTP m64int",               dest r/m64,      src st(0),                                    fpustackpush;

opcode 0xE0 cb,               name "LOOPNZ",         display "LOOPNZ rel8",                dest rw ip,      src rel8;
opcode 0xE1 cb,               name "LOOPZ",          display "LOOPZ rel8",                 dest rw ip,      src rel8;
opcode 0xE2 cb,               name "LOOP",           display "LOOP rel8",                  dest rw ip,      src rel8;
opcode 0xE3 cb,               name "JCXZ",           display "JCXZ rel8",                  dest rw ip,      src rel8;

opcode 0xE4 ib,               name "IN",             display "IN al,imm8",                 dest w al,       src imm8;
opcode 0xE5 iw,               name "IN",             display "IN ax,imm16",                dest w ax,       src imm16;
opcode 0xE6 ib,               name "OUT",            display "OUT imm8,al",                                 src al imm8;
opcode 0xE7 iw,               name "OUT",            display "OUT imm16,ax",                                src ax imm16;

opcode 0xE8 cw,               name "CALL",           display "CALL rel16",                 dest rw ip,      src rel16;
opcode 0xE9 cw,               name "JMP",            display "JMP rel16",                  dest rw ip,      src rel16;

opcode 0xEA cd,               name "JMP",            display "JMP ptr16:16",               dest rw cs:ip,   src ptr16:16;

opcode 0xEB cb,               name "JMP",            display "JMP rel8",                   dest rw ip,      src rel8;

opcode 0xEC,                  name "IN",             display "IN al,dx",                   dest w al,       src dx;
opcode 0xED,                  name "IN",             display "IN ax,dx",                   dest w ax,       src dx;

opcode 0xEE,                  name "OUT",            display "OUT dx,al",                                   src dx al;
opcode 0xEF,                  name "OUT",            display "OUT dx,ax",                                   src dx ax;

opcode 0xF0,                  name "LOCK",           display "LOCK",                       prefix lock;
opcode 0xF1,                  alias of 0xF0;

opcode 0xF2,                  name "REPNZ",          display "REPNZ",                      prefix rep zf=0;
opcode 0xF3,                  name "REPZ",           display "REPZ",                       prefix rep zf=1;

opcode 0xF4,                  name "HLT",            display "HLT",                        flow interruption;

opcode 0xF5,                  name "CMC",            display "CMC",                        dest rw flags;

opcode 0xF6 /0 ib,            name "TEST",           display "TEST r/m8, imm8",                             src r/m8 imm8;
opcode 0xF6 /2,               name "NOT",            display "NOT r/m8",                   dest rw r/m8;
opcode 0xF6 /3,               name "NEG",            display "NEG r/m8",                   dest rw r/m8;
opcode 0xF6 /4,               name "MUL",            display "MUL r/m8",                   dest rw ax,      src al r/m8;
opcode 0xF6 /5,               name "IMUL",           display "IMUL r/m8",                  dest rw ax,      src al r/m8;
opcode 0xF6 /6,               name "DIV",            display "DIV r/m8",                   dest rw ax,      src ax r/m8;
opcode 0xF6 /7,               name "IDIV",           display "IDIV r/m8",                  dest rw ax,      src ax r/m8;
opcode 0xF7 /0 iw,            name "TEST",           display "TEST r/m16, imm16",                           src r/m16 imm16;
opcode 0xF7 /2,               name "NOT",            display "NOT r/m16",                  dest rw r/m16;
opcode 0xF7 /3,               name "NEG",            display "NEG r/m16",                  dest rw r/m16;
opcode 0xF7 /4,               name "MUL",            display "MUL r/m16",                  dest rw dx ax,   src ax r/m16;
opcode 0xF7 /5,               name "IMUL",           display "IMUL r/m16",                 dest rw dx ax,   src ax r/m16;
opcode 0xF7 /6,               name "DIV",            display "DIV r/m16",                  dest rw dx ax,   src dx ax r/m16;
opcode 0xF7 /7,               name "IDIV",           display "IDIV r/m16",                 dest rw dx ax,   src dx ax r/m16;

opcode 0xF8,                  name "CLC",            display "CLC",                        dest rw flags;
opcode 0xF9,                  name "STC",            display "STC",                        dest rw flags;
opcode 0xFA,                  name "CLI",            display "CLI",                        dest rw flags;
opcode 0xFB,                  name "STI",            display "STI",                        dest rw flags;
opcode 0xFC,                  name "CLD",            display "CLD",                        dest rw flags;
opcode 0xFD,                  name "STD",            display "STD",                        dest rw flags;

opcode 0xFE /0,               name "INC",            display "INC r/m8",                   dest rw r/m8;
opcode 0xFE /1,               name "DEC",            display "DEC r/m8",                   dest rw r/m8;

opcode 0xFF /0,               name "INC",            display "INC r/m16",                  dest rw r/m16;
opcode 0xFF /1,               name "DEC",            display "DEC r/m16",                  dest rw r/m16;
opcode 0xFF /2,               name "CALL",           display "CALL r/m16",                 dest rw ip,      src r/m16;
opcode 0xFF /3,               name "CALL",           display "CALL m16:16",                dest rw cs:ip,   src r/m16*2;
opcode 0xFF /4,               name "JMP",            display "JMP r/m16",                  dest w ip,       src r/m16;
opcode 0xFF /5,               name "JMP",            display "JMP m16:16",                 dest w cs:ip     src r/m16*2;
opcode 0xFF /6,               name "PUSH",           display "PUSH r/m16",                 dest w stack16,  src r/m16;

